<!DOCTYPE html>
<html lang="en">
  <head>
    <title>FP KAMAR COWO in 3D</title>
  </head>
  <body style="background-color: black"></body>
</html>
<script type="module">
  import * as THREE from "https://threejsfundamentals.org/threejs/resources/threejs/r132/build/three.module.js";
  import { OrbitControls } from "https://threejsfundamentals.org/threejs/resources/threejs/r132/examples/jsm/controls/OrbitControls.js";
  import { GLTFLoader } from "https://threejsfundamentals.org/threejs/resources/threejs/r132/examples/jsm/loaders/GLTFLoader.js";

  let scene,
    camera,
    renderer,
    shepre,
    target,
    texture,
    light,
    light1,
    light2,
    cube,
    lightHelper1,
    lightHelper2,
    plane,
    geometry,
    material;
  let sphere_dalam, controls, root;
  let ADD = 0.001,
    theta = 0;

  //memuat gltf kamar
  let createGeometry = function () {
    const gltfLoader1 = new GLTFLoader();
    const url1 = "blender/kamar22.gltf";
    gltfLoader1.load(url1, (gltf) => {
      gltf.scene.scale.set(0.1, 0.1, 0.1);
      root = gltf.scene;
      root.position.set(0, 0, 0);
      scene.add(root);

      //buat shadow dari objectnya
      root.traverse((obj) => {
        if (obj.castShadow !== undefined) {
          obj.castShadow = true;
          obj.receiveShadow = true;
        }
      });
    });
  };

  // set up the environment -
  // initiallize scene, camera, objects and renderer

  let init = function () {
    // 1. create the scene
    scene = new THREE.Scene();
    scene.background = new THREE.Color(0x212121);

    // const axesHelper = new THREE.AxesHelper(15);
    // scene.add(axesHelper);

    camera = new THREE.PerspectiveCamera(
      60,
      window.innerWidth / window.innerHeight,
      1,
      1000
    );
    camera.position.set(-5, 3, -3);

    light = new THREE.AmbientLightProbe(0xffffff, 1); // ceritanya lampu putih atas
    scene.add(light);

    light1 = new THREE.DirectionalLight(0x2d46b9, 1); // ceritanya lampu biru kanan
    light1.position.set(-3.85, 2, 0);

    light2 = new THREE.DirectionalLight(0xf037a5, 1); // ceritanya lampu violet kanan
    light2.position.set(0, 2, -4);
    //shadow
    light1.castShadow = true;
    light1.shadow.radius = 2;
    scene.add(light1);

    light2.castShadow = true;
    light2.shadow.radius = 1;
    scene.add(light2);
    // 3. create an locate the object on the scene

    // lightHelper1 = new THREE.DirectionalLightHelper(light1, 1, 0x000000);
    // scene.add(lightHelper1);

    // lightHelper2 = new THREE.DirectionalLightHelper(light2, 1, 0x000000);
    // scene.add(lightHelper2);

    createGeometry(); // 4. create the renderer
    renderer = new THREE.WebGLRenderer({ antialiasing: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.shadowMap.enabled = true;
    renderer.shadowMap.type = THREE.VSMShadowMap; //jenis bayangan yng dipakai
    renderer.receiveShadow = true;

    document.body.appendChild(renderer.domElement);

    // controls
    controls = new OrbitControls(camera, renderer.domElement);
    controls.listenToKeyEvents(window);

    controls.enableDamping = true;
    controls.dampingFactor = 0.05;
  }; // main animation loop - calls 50-60 in a second.
  let mainLoop = function () {
    renderer.render(scene, camera);
    controls.update();
    requestAnimationFrame(mainLoop);
  }; ///////////////////////////////////////////////
  init();
  mainLoop();
</script>
